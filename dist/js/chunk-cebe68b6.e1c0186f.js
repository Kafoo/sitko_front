(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cebe68b6"],{"0636":function(e,t,a){"use strict";a("af89")},5558:function(e,t,a){},7549:function(e,t,a){},"94b8":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"text-center"},[a("create-button",{attrs:{item:e.$t("event")},on:{action:function(t){e.creating=!0}}})],1),a("v-select",{attrs:{items:e.types,label:"Type",outlined:""},model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}}),e.loading_events||e.events.length?e.loading_events||e.activeEvents.length?e._e():a("h4",{staticClass:"text-center"},[e._v(" -- "+e._s(e.$t("data.empty_typed",{item:e.$t("event")}))+" -- ")]):a("h4",{staticClass:"text-center"},[e._v(" -- "+e._s(e.$t("data.empty",{item:e.$t("event")}))+" -- ")]),e.loading_events?a("div",{staticClass:"d-flex flex-column"},[a("skeleton-index")],1):a("div",[a("transition-group",{staticClass:"events d-flex flex-column",attrs:{name:"list-complete",tag:"p"}},e._l(e.activeEvents,(function(t,i){return a("div",{key:t.id,staticClass:"list-complete-item"},[a("card-event",{attrs:{event:t,index:i,expanded:t.expanded},on:{toogleExpand:function(a){return e.toogleExpand(t.id)},openEdit:e.openEdit,deleteEvent:e.SEND_EVENT_DELETION,toogleImage:e.toogleImage}})],1)})),0),a("v-dialog",{attrs:{width:"500"},model:{value:e.creating,callback:function(t){e.creating=t},expression:"creating"}},[a("create-event",{on:{closeCreation:e.closeCreation}})],1),a("v-dialog",{attrs:{width:"500"},model:{value:e.editing,callback:function(t){e.editing=t},expression:"editing"}},[a("edit-event",{attrs:{propEvent:e.editionEvent},on:{closeEdit:e.closeEdit}})],1),a("v-dialog",{attrs:{width:"90%"},model:{value:e.expand_image,callback:function(t){e.expand_image=t},expression:"expand_image"}},[a("image-popup",{attrs:{image:e.expanded_image},on:{toogleImage:e.toogleImage}})],1)],1)],1)},n=[],s=(a("4de4"),a("fb6a"),a("5530")),c=a("2f62"),o=(a("bc3a"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"pt-7 pb-3 px-4"},[e.pickingDate?e._e():a("div",{staticClass:"card-body py-0"},[a("v-form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.sendEdit(t)}},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("v-text-field",{attrs:{outlined:"",label:e._f("capitalize")(e.$t("title")),rules:[e.rules.required]},model:{value:e.editedEvent.title,callback:function(t){e.$set(e.editedEvent,"title",t)},expression:"editedEvent.title"}}),a("v-select",{attrs:{label:e._f("capitalize")(e.$t("type")),type:"type",id:"type",items:e.types,rules:[e.rules.required],solo:"","max-width":"200px"},model:{value:e.editedEvent.type,callback:function(t){e.$set(e.editedEvent,"type",t)},expression:"editedEvent.type"}}),a("v-textarea",{attrs:{outlined:"",label:e._f("capitalize")(e.$t("description")),name:"input-7-4",rules:[e.rules.required]},model:{value:e.editedEvent.description,callback:function(t){e.$set(e.editedEvent,"description",t)},expression:"editedEvent.description"}}),e.editedEvent.image&&!e.editedEvent.imageChanged?a("div",{staticClass:"imgContainer"},[a("img",{attrs:{src:e.editedEvent.image.thumb}}),a("v-btn",{staticClass:"close",attrs:{color:"secondary",fab:"","x-small":"",dark:""},on:{click:e.removeImage}},[a("v-icon",[e._v("close")])],1)],1):a("v-file-input",{attrs:{rules:[e.rules.image],accept:"image/jpeg",label:e._f("capitalize")(e.$t("image")),"prepend-icon":"insert_photo"},on:{change:e.imageChange},model:{value:e.editedEvent.file,callback:function(t){e.$set(e.editedEvent,"file",t)},expression:"editedEvent.file"}}),a("v-chip-group",{staticClass:"d-flex align-center",attrs:{column:""}},[!e.editedEvent.caldates||e.editedEvent.caldates&&!e.editedEvent.caldates.length?a("v-chip",{staticClass:"py-5",on:{click:function(t){e.pickingDate=!0}}},[e._v(" "+e._s(e._f("capitalize")(e.$t("actions.add",{item:e.$t("caldate")})))+" ")]):e._e(),e._l(e.editedEvent.caldates,(function(t,i){return a("v-tooltip",{key:i,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var s=n.on;return[a("v-chip",e._g({staticClass:"caldate-chip py-6 mt-0",attrs:{close:""},on:{"click:close":function(t){return e.removeCaldate(i)}}},s),[t.singleDate?a("v-icon",{staticClass:"px-2"},[e._v("today")]):a("v-icon",{staticClass:"px-2"},[e._v("date_range")])],1)]}}],null,!0)},[a("span",[e._v(e._s(t.chip))])])})),e.editedEvent.caldates&&e.editedEvent.caldates.length?a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.showCaldates?a("v-btn",e._g({attrs:{icon:"",height:"45",width:"45",color:"green"},on:{click:function(t){e.pickingDate=!0}}},i),[a("v-icon",[e._v("add")])],1):e._e()]}}],null,!1,1746415089)},[a("span",[e._v(" "+e._s(e._f("capitalize")(e.$t("actions.add",{item:e.$t("caldate")})))+" ")])]):e._e()],2),a("v-divider",{staticClass:"mb-0"}),a("v-card-actions",{staticClass:"actions d-flex justify-end"},[a("v-spacer"),a("v-btn",{attrs:{disabled:e.loading,text:""},on:{click:e.closeEdit}},[e._v(" "+e._s(e.$t("confirm.cancel"))+" ")]),a("v-btn",{attrs:{color:"primary",type:"submit",disabled:e.loading||!e.form,text:""}},[e._v(" "+e._s(e.$t("confirm.confirm"))+" ")]),e.loading?a("v-progress-linear",{staticClass:"progress",attrs:{color:"green darken-4 accent-4",indeterminate:"",rounded:"",height:"6"}}):e._e()],1)],1)],1),e.pickingDate?a("ChooseDate",{staticClass:"choose-date",on:{closeDatePicker:e.closeDatePicker,addCaldate:e.addCaldate}}):e._e()],1)}),l=[],r=(a("a434"),a("2c2a")),d={name:"EditEvent",components:{ChooseDate:r["a"]},data:function(){return{form:!1,loading:!1,pickingDate:!1,editedEvent:{},types:["ferme","écolieu","autre"]}},mounted:function(){this.editedEvent=JSON.parse(JSON.stringify(this.propEvent))},props:{propEvent:Object,showCaldates:{type:Boolean,default:!0}},computed:{rules:function(){var e=this;return{required:function(t){return!!t||e.$options.filters.capitalize(e.$t("form.required"))},image:function(t){return!t||t.size<3e6||e.$options.filters.capitalize(e.$t("media.max_size",{max:"3 MB"}))}}}},watch:{propEvent:function(e){this.editedEvent=JSON.parse(JSON.stringify(e))}},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])("event",["SEND_EVENT_EDITION"])),{},{closeEdit:function(){this.$emit("closeEdit")},sendEdit:function(){var e=this;this.loading=!0,this.editedEvent.eventOnly=!this.showCaldates,this.SEND_EVENT_EDITION(this.editedEvent).then((function(){e.$emit("closeEdit"),e.loading=!1})).catch((function(){e.loading=!1}))},closeDatePicker:function(){this.pickingDate=!1},addCaldate:function(e){this.editedEvent.caldates.push(e)},removeCaldate:function(e){this.editedEvent.caldates.splice(e,1)},imageChange:function(){var e=this;if(this.editedEvent.imageChanged=!0,this.editedEvent.file){var t=new FileReader;t.readAsDataURL(this.editedEvent.file),t.onload=function(t){e.editedEvent.image=t.target.result}}else this.editedEvent.image=null},removeImage:function(){this.editedEvent.imageChanged=!0,this.editedEvent.image=null}})},v=d,p=(a("0636"),a("2877")),u=a("6544"),m=a.n(u),f=a("8336"),h=a("b0af"),g=a("99d9"),_=a("cc20"),E=a("ef9a"),x=a("ce7e"),b=a("23a7"),C=a("4bd4"),y=a("132d"),k=a("8e36"),w=a("b974"),$=a("2fa4"),V=a("8654"),D=a("a844"),T=a("3a2f"),O=Object(p["a"])(v,o,l,!1,null,"4b5179e9",null),N=O.exports;m()(O,{VBtn:f["a"],VCard:h["a"],VCardActions:g["a"],VChip:_["a"],VChipGroup:E["a"],VDivider:x["a"],VFileInput:b["a"],VForm:C["a"],VIcon:y["a"],VProgressLinear:k["a"],VSelect:w["a"],VSpacer:$["a"],VTextField:V["a"],VTextarea:D["a"],VTooltip:T["a"]});var I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"pt-7 pb-3 px-4"},[e.pickingDate?e._e():a("div",{staticClass:"card-body"},[a("v-form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.createEvent(t)}},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("div",{staticClass:"mb-4"},[a("label",{staticClass:"title",attrs:{for:"title"}},[e._v(" "+e._s(e._f("camelize")(e.$t("actions.new",{item:e.$t("event")})))+" ")])]),a("v-text-field",{attrs:{label:e._f("capitalize")(e.$t("title")),outlined:"",rules:[e.rules.required],disabled:e.loading},model:{value:e.newEvent.title,callback:function(t){e.$set(e.newEvent,"title",t)},expression:"newEvent.title"}}),a("v-select",{attrs:{label:e._f("capitalize")(e.$t("type")),type:"type",id:"type",items:e.types,rules:[e.rules.required],solo:"","max-width":"200px"},model:{value:e.newEvent.type,callback:function(t){e.$set(e.newEvent,"type",t)},expression:"newEvent.type"}}),a("v-textarea",{attrs:{label:e._f("capitalize")(e.$t("description")),type:"description",id:"description",outlined:"",rules:[e.rules.required],name:"input-7-4",disabled:e.loading},model:{value:e.newEvent.description,callback:function(t){e.$set(e.newEvent,"description",t)},expression:"newEvent.description"}}),a("v-file-input",{attrs:{label:e._f("capitalize")(e.$t("image")),rules:[e.rules.image],accept:"image/jpeg"},on:{change:e.changeImage},model:{value:e.newEvent.file,callback:function(t){e.$set(e.newEvent,"file",t)},expression:"newEvent.file"}}),a("v-chip-group",{attrs:{column:""}},[!e.newEvent.caldates||e.newEvent.caldates&&!e.newEvent.caldates.length?a("v-chip",{staticClass:"py-5",on:{click:function(t){e.pickingDate=!0}}},[e._v(" "+e._s(e._f("capitalize")(e.$t("actions.add",{item:e.$t("caldate")})))+" ")]):e._e(),e._l(e.newEvent.caldates,(function(t,i){return a("v-tooltip",{key:i,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var s=n.on;return[a("v-chip",e._g({staticClass:"caldate-chip py-6 mt-0",attrs:{close:""},on:{"click:close":function(t){return e.removeCaldate(i)}}},s),[t.singleDate?a("v-icon",{staticClass:"px-2"},[e._v("today")]):a("v-icon",{staticClass:"px-2"},[e._v("date_range")])],1)]}}],null,!0)},[a("span",[e._v(e._s(t.chip))])])})),e.newEvent.caldates&&e.newEvent.caldates.length?a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({attrs:{icon:"",height:"45",width:"45",color:"green"},on:{click:function(t){e.pickingDate=!0}}},i),[a("v-icon",[e._v("add")])],1)]}}],null,!1,687051364)},[a("span",[e._v(" "+e._s(e._f("capitalize")(e.$t("actions.add",{item:e.$t("caldate")})))+" ")])]):e._e()],2),a("v-card-actions",{staticClass:"d-flex justify-center"},[a("v-btn",{attrs:{disabled:e.loading},on:{click:e.cancel}},[e._v(" "+e._s(e.$t("confirm.cancel"))+" ")]),a("v-btn",{attrs:{type:"submit",disabled:e.loading||!e.form}},[e._v(" "+e._s(e.$t("confirm.confirm"))+" ")])],1)],1),e.loading?a("v-progress-linear",{staticClass:"progress",attrs:{color:"green darken-4 accent-4",indeterminate:"",rounded:"",height:"6"}}):e._e()],1),e.pickingDate?a("ChooseDate",{staticClass:"choose-date",on:{closeDatePicker:e.closeDatePicker,addCaldate:e.addCaldate}}):e._e()],1)},j=[],S={name:"CreateEvent",data:function(){return{place_id:this.$route.params.id,form:!1,loading:!1,pickingDate:!1,newEvent:{place_id:this.$route.params.id,caldates:[]},types:["ferme","écolieu","autre"]}},components:{ChooseDate:r["a"]},props:{event:Object},computed:{rules:function(){var e=this;return{required:function(t){return!!t||e.$options.filters.capitalize(e.$t("form.required"))},image:function(t){return!t||t.size<3e6||e.$options.filters.capitalize(e.$t("media.max_size",{max:"3 MB"}))}}}},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])("event",["SEND_EVENT_CREATION"])),{},{cancel:function(){this.resetEvent(),this.$emit("closeCreation")},resetEvent:function(){this.newEvent={place_id:this.place_id,caldates:[]}},createEvent:function(){var e=this;this.loading=!0,this.SEND_EVENT_CREATION(this.newEvent).then((function(){e.loading=!1,e.$emit("closeCreation"),e.resetEvent()})).catch((function(){e.loading=!1}))},closeDatePicker:function(){this.pickingDate=!1},addCaldate:function(e){this.newEvent.caldates.push(e)},removeCaldate:function(e){this.newEvent.caldates.splice(e,1)},changeImage:function(){var e=this;if(this.newEvent.file){var t=new FileReader;t.readAsDataURL(this.newEvent.file),t.onload=function(t){e.newEvent.image=t.target.result}}else this.newEvent.image=void 0}})},z=S,P=Object(p["a"])(z,I,j,!1,null,null,null),A=P.exports;m()(P,{VBtn:f["a"],VCard:h["a"],VCardActions:g["a"],VChip:_["a"],VChipGroup:E["a"],VFileInput:b["a"],VForm:C["a"],VIcon:y["a"],VProgressLinear:k["a"],VSelect:w["a"],VTextField:V["a"],VTextarea:D["a"],VTooltip:T["a"]});var L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.hover;return[a("v-card",{staticClass:"event ma-1",class:{"on-hover":i},attrs:{id:e.event.id,elevation:i?4:2}},[a("div",{staticClass:"d-flex event-main",on:{click:function(t){return e.$emit("toogleExpand")}}},[a("v-card-title",{staticClass:"d-inline-block py-3 text-truncate"},[a("v-chip",{staticClass:"type hidden-xs-only white--text rounded-lg",class:e.event.color},[e._v(" "+e._s(e.event.type)+" ")]),e._v(" "+e._s(e.event.title)+" ")],1),a("v-spacer"),a("v-card-actions",[a("v-btn",{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.$emit("openEdit",e.index)}}},[a("v-icon",[e._v("create")])],1),a("v-btn",{attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.deleting=!0}}},[a("v-icon",[e._v("delete")])],1),a("v-btn",{attrs:{icon:""}},[a("v-icon",[e._v(e._s(e.expanded?"expand_less":"expand_more"))])],1)],1)],1),a("v-expand-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}],staticClass:"expand"},[a("v-divider",{staticClass:"my-0"}),a("v-card-text",{staticClass:"pt-2",attrs:{"min-height":"200px"}},[a("div",{staticClass:"d-flex flex-column-reverse align-start flex-sm-row"},[e.event.image?a("v-img",{staticClass:"image mr-sm-3 mb-sm-3 mt-sm-0 mt-3 flex-grow-0",attrs:{"lazy-src":e.event.image.low_medium,src:e.event.image.medium},on:{click:function(t){return e.$emit("toogleImage",e.event.image)}},scopedSlots:e._u([{key:"placeholder",fn:function(){return[a("v-row",{staticClass:"image_placeholder fill-height ma-0",attrs:{align:"center",justify:"center"}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}],null,!0)}):e._e(),e.event.image?a("v-divider",{staticClass:"hidden-xs-only mr-2",attrs:{vertical:""}}):e._e(),a("div",{staticClass:"flex-grow-1"},[a("div",{staticClass:"d-flex flex-wrap"},[a("v-chip",{staticClass:"type hidden-sm-and-up white--text rounded-lg my-1 mr-2",class:e.event.color},[e._v(" "+e._s(e.event.type)+" ")]),a("v-chip-group",{attrs:{column:""}},e._l(e.event.caldates,(function(t){return a("v-tooltip",{key:t.id,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var n=i.on;return[a("v-chip",e._g({staticClass:"c-default pa-2 mt-0"},n),[t.singleDate?a("v-icon",[e._v("today")]):a("v-icon",[e._v("date_range")])],1)]}}],null,!0)},[a("span",[e._v(e._s(t.chip))])])})),1)],1),a("v-clamp",{staticClass:"description",attrs:{autoresize:"","max-lines":10}}),a("span",{staticStyle:{"white-space":"pre-wrap"},attrs:{width:"100%"}},[e._v(e._s(e.event.description))])],1)],1)])],1)]),a("v-dialog",{attrs:{width:"500"},model:{value:e.deleting,callback:function(t){e.deleting=t},expression:"deleting"}},[a("v-card",{staticClass:"pt-7 pb-3"},[a("v-card-text",{staticClass:"text-h6"},[e._v(" "+e._s(e.$t("This event will be removed definitely"))+" ")]),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.deleting=!1}}},[e._v(" "+e._s(e.$t("confirm.cancel"))+" ")]),a("v-btn",{attrs:{color:"red",text:""},on:{click:function(t){return e.$emit("deleteEvent",e.event.id)}}},[e._v(" "+e._s(e.$t("delete"))+" ")])],1)],1)],1)],1)]}}])})},q=[],B=(a("a9e3"),a("3f87")),F={name:"CardEvent",components:{VClamp:B["a"]},props:{event:Object,index:Number,expanded:Boolean},data:function(){return{deleting:!1,color:"red"}}},G=F,R=(a("988f"),a("169a")),J=a("0789"),X=a("ce87"),M=a("adda"),U=a("490a"),H=a("0fd9"),K=Object(p["a"])(G,L,q,!1,null,"14997ad8",null),Q=K.exports;m()(K,{VBtn:f["a"],VCard:h["a"],VCardActions:g["a"],VCardText:g["b"],VCardTitle:g["c"],VChip:_["a"],VChipGroup:E["a"],VDialog:R["a"],VDivider:x["a"],VExpandTransition:J["a"],VHover:X["a"],VIcon:y["a"],VImg:M["a"],VProgressCircular:U["a"],VRow:H["a"],VSpacer:$["a"],VTooltip:T["a"]});var W=a("3063"),Y=a("375f"),Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l([1,2,3,4],(function(e){return a("v-skeleton-loader",{key:e,staticClass:"boilerplate ma-1 elevation-3",attrs:{height:"60",type:"table-heading"}})})),1)},ee=[],te=a("3129"),ae={},ie=Object(p["a"])(ae,Z,ee,!1,null,null,null),ne=ie.exports;m()(ie,{VSkeletonLoader:te["a"]});var se={name:"Events",components:{EditEvent:N,CreateEvent:A,CardEvent:Q,ImagePopup:W["a"],CreateButton:Y["a"],SkeletonIndex:ne},data:function(){return{hash:null,place_id:this.$route.params.id,expand_image:!1,expanded_image:{},editing:!1,creating:!1,activeType:"",editionEvent:{}}},mounted:function(){this.activeType=this.types[0],location.hash&&(this.hash=location.hash),location.hash="";var e={place_id:this.place_id,hash:this.hash};this.GET_PLACE_EVENTS(e)},watch:{loading_events:function(){var e=this;!1===this.loading_events&&this.$nextTick((function(){if(e.hash){var t=e.hash.slice(1);e.TOOGLE_EVENT_EXPAND(t),setTimeout((function(){document.getElementById(t).scrollIntoView({behavior:"smooth"})}),300)}}))},types:function(){this.activeType=this.types[0]}},computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])("event",["loading_events","events"])),{},{types:function(){return[this.$t("all"),"ferme","écolieu","autre"]},activeEvents:function(){var e=this;return this.activeType===this.$t("all")?this.events:this.events.filter((function(t){return t.type===e.activeType}))}}),methods:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(c["b"])("event",["GET_PLACE_EVENTS","SEND_EVENT_DELETION","TOOGLE_EVENT_EXPAND"])),Object(c["d"])("event",["closeExpands"])),{},{openEdit:function(e){this.editionEvent=this.events[e],this.editing=!0},closeEdit:function(){this.editing=!1,this.editionEvent={}},closeCreation:function(){this.creating=!1},toogleImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.expanded_image=e,this.expand_image=!this.expand_image},toogleExpand:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.TOOGLE_EVENT_EXPAND(e)}})},ce=se,oe=(a("9e41"),Object(p["a"])(ce,i,n,!1,null,"8bf48e32",null));t["default"]=oe.exports;m()(oe,{VDialog:R["a"],VSelect:w["a"]})},"988f":function(e,t,a){"use strict";a("5558")},"9e41":function(e,t,a){"use strict";a("7549")},af89:function(e,t,a){}}]);
//# sourceMappingURL=chunk-cebe68b6.e1c0186f.js.map